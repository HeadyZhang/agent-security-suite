
======================================================================
  agent-audit v0.8.0 — OpenHands Scan Results Analysis
======================================================================

Scanned files: 1068
Total findings: 455

By Tier:
  BLOCK: 30
  WARN: 101
  INFO: 212
  SUPPRESSED: 112

By Rule:
  AGENT-026: 114  (INFO: 87, SUPPRESSED: 7, WARN: 20)
  AGENT-034: 78  (BLOCK: 2, INFO: 39, SUPPRESSED: 2, WARN: 35)
  AGENT-018: 75  (BLOCK: 4, INFO: 32, SUPPRESSED: 39)
  AGENT-020: 61  (SUPPRESSED: 61)
  AGENT-004: 57  (BLOCK: 11, INFO: 38, WARN: 8)
  AGENT-047: 44  (INFO: 9, WARN: 35)
  AGENT-001: 17  (BLOCK: 9, INFO: 7, SUPPRESSED: 1)
  AGENT-045: 3  (WARN: 3)
  AGENT-028: 2  (BLOCK: 1, SUPPRESSED: 1)
  AGENT-040: 2  (BLOCK: 1, SUPPRESSED: 1)
  AGENT-044: 2  (BLOCK: 2)

======================================================================
  BLOCK Tier Detail (30 findings)
======================================================================

  [AGENT-001] /tmp/openhands-scan-target/openhands/runtime/plugins/jupyter/__init__.py:81 (conf=1.0, infra=False)
    Tool accepts user input passed directly to shell execution without proper saniti

  [AGENT-001] /tmp/openhands-scan-target/openhands/runtime/utils/git_diff.py:26 (conf=1.0, infra=False)
    Tool accepts user input passed directly to shell execution without proper saniti

  [AGENT-001] /tmp/openhands-scan-target/openhands/runtime/utils/git_changes.py:14 (conf=1.0, infra=False)
    Tool accepts user input passed directly to shell execution without proper saniti

  [AGENT-001] /tmp/openhands-scan-target/openhands/resolver/send_pull_request.py:156 (conf=1.0, infra=False)
    Tool accepts user input passed directly to shell execution without proper saniti

  [AGENT-001] /tmp/openhands-scan-target/openhands/resolver/send_pull_request.py:186 (conf=1.0, infra=False)
    Tool accepts user input passed directly to shell execution without proper saniti

  [AGENT-001] /tmp/openhands-scan-target/openhands/resolver/send_pull_request.py:195 (conf=1.0, infra=False)
    Tool accepts user input passed directly to shell execution without proper saniti

  [AGENT-001] /tmp/openhands-scan-target/openhands/resolver/send_pull_request.py:205 (conf=1.0, infra=False)
    Tool accepts user input passed directly to shell execution without proper saniti

  [AGENT-001] /tmp/openhands-scan-target/openhands/resolver/send_pull_request.py:213 (conf=1.0, infra=False)
    Tool accepts user input passed directly to shell execution without proper saniti

  [AGENT-001] /tmp/openhands-scan-target/openhands/resolver/send_pull_request.py:517 (conf=1.0, infra=False)
    Tool accepts user input passed directly to shell execution without proper saniti

  [AGENT-004] /tmp/openhands-scan-target/tests/unit/core/logger/test_logging.py:79 (conf=1.0, infra=False)
    Found AWS Access Key in source code

  [AGENT-004] /tmp/openhands-scan-target/tests/unit/core/logger/test_logging.py:85 (conf=1.0, infra=False)
    Found AWS Access Key in source code

  [AGENT-004] /tmp/openhands-scan-target/tests/unit/core/logger/test_logging.py:50 (conf=1.0, infra=False)
    Found Generic API Key/Secret in source code

  [AGENT-004] /tmp/openhands-scan-target/tests/unit/core/logger/test_logging.py:59 (conf=1.0, infra=False)
    Found Generic API Key/Secret in source code

  [AGENT-004] /tmp/openhands-scan-target/tests/unit/security/test_security.py:159 (conf=1.0, infra=False)
    Found AWS Access Key in source code

  [AGENT-004] /tmp/openhands-scan-target/openhands/server/routes/secrets.py:201 (conf=1.0, infra=False)
    Found Generic API Key/Secret in source code

  [AGENT-004] /tmp/openhands-scan-target/openhands/server/routes/secrets.py:269 (conf=1.0, infra=False)
    Found Generic API Key/Secret in source code

  [AGENT-028] /tmp/openhands-scan-target/openhands/server/conversation_manager/standalone_conversation_manager.py:362 (conf=1.0, infra=False)
    Agent configuration lacks iteration limits, which can lead to cascading failures

  [AGENT-040] /tmp/openhands-scan-target/openhands/server/conversation_manager/standalone_conversation_manager.py:362 (conf=1.0, infra=False)
    AgentExecutor or create_react_agent is instantiated without proper safety parame

  [AGENT-004] /tmp/openhands-scan-target/frontend/src/utils/websocket-url.ts:23 (conf=0.98, infra=False)
    Found Potential AWS Secret Key

  [AGENT-004] /tmp/openhands-scan-target/openhands/app_server/app_lifespan/alembic/env.py:78 (conf=0.98, infra=False)
    Found Database Connection String with Credentials

  [AGENT-004] /tmp/openhands-scan-target/openhands/runtime/utils/git_diff.py:61 (conf=0.98, infra=False)
    Found Potential AWS Secret Key

  [AGENT-004] /tmp/openhands-scan-target/openhands/runtime/utils/git_changes.py:49 (conf=0.98, infra=False)
    Found Potential AWS Secret Key

  [AGENT-018] /tmp/openhands-scan-target/enterprise/server/saas_nested_conversation_manager.py:1014 (conf=0.95, infra=False)
    User or external input is written to the agent's persistent memory (vector datab

  [AGENT-018] /tmp/openhands-scan-target/enterprise/storage/user_store.py:129 (conf=0.95, infra=False)
    User or external input is written to the agent's persistent memory (vector datab

  [AGENT-018] /tmp/openhands-scan-target/openhands/server/routes/secrets.py:50 (conf=0.95, infra=False)
    User or external input is written to the agent's persistent memory (vector datab

  [AGENT-018] /tmp/openhands-scan-target/openhands/server/routes/secrets.py:252 (conf=0.95, infra=False)
    User or external input is written to the agent's persistent memory (vector datab

  [AGENT-034] /tmp/openhands-scan-target/openhands/runtime/utils/git_diff.py:26 (conf=0.95, infra=False)
    A tool function accepts string or Any parameters without performing input valida

  [AGENT-034] /tmp/openhands-scan-target/openhands/runtime/utils/git_changes.py:14 (conf=0.95, infra=False)
    A tool function accepts string or Any parameters without performing input valida

  [AGENT-044] /tmp/openhands-scan-target/openhands/runtime/utils/runtime_init.py:23 (conf=0.95, infra=False)
    Configures or guides NOPASSWD sudoers entry. This allows password-less sudo acce

  [AGENT-044] /tmp/openhands-scan-target/openhands/runtime/utils/runtime_init.py:88 (conf=0.95, infra=False)
    Configures or guides NOPASSWD sudoers entry. This allows password-less sudo acce


======================================================================
  Critical Rule Checks
======================================================================

AGENT-044 (Sudoers): 2 findings, 2 in BLOCK
  ✅ PRESERVED — 标杆规则仍然有效
AGENT-034 (Input Validation): 78 findings, 37 in BLOCK+WARN
AGENT-020 (Unencrypted Channel): 61 total, 0 non-SUPPRESSED
  ✅ TEST FP ELIMINATED — localhost URLs suppressed
AGENT-045 (Browser No Sandbox): 3 total, 3 non-SUPPRESSED
  ⚠️  Still 3 non-SUPPRESSED (was 3 in v0.7.0)
AGENT-004 (Hardcoded Creds): 57 findings
  [BLOCK] /tmp/openhands-scan-target/tests/unit/core/logger/test_logging.py (conf=1.0)
  [BLOCK] /tmp/openhands-scan-target/tests/unit/core/logger/test_logging.py (conf=1.0)
  [BLOCK] /tmp/openhands-scan-target/tests/unit/core/logger/test_logging.py (conf=1.0)
  [BLOCK] /tmp/openhands-scan-target/tests/unit/core/logger/test_logging.py (conf=1.0)
  [BLOCK] /tmp/openhands-scan-target/tests/unit/security/test_security.py (conf=1.0)
  [BLOCK] /tmp/openhands-scan-target/openhands/server/routes/secrets.py (conf=1.0)
  [BLOCK] /tmp/openhands-scan-target/openhands/server/routes/secrets.py (conf=1.0)
  [BLOCK] /tmp/openhands-scan-target/frontend/src/utils/websocket-url.ts (conf=0.98)
  [BLOCK] /tmp/openhands-scan-target/openhands/app_server/app_lifespan/alembic/env.py (conf=0.98)
  [BLOCK] /tmp/openhands-scan-target/openhands/runtime/utils/git_diff.py (conf=0.98)
  [BLOCK] /tmp/openhands-scan-target/openhands/runtime/utils/git_changes.py (conf=0.98)
  [WARN] /tmp/openhands-scan-target/frontend/src/api/secrets-service.ts (conf=0.7)
  [WARN] /tmp/openhands-scan-target/frontend/src/i18n/declaration.ts (conf=0.7)
  [WARN] /tmp/openhands-scan-target/frontend/src/i18n/declaration.ts (conf=0.7)
  [WARN] /tmp/openhands-scan-target/frontend/src/i18n/declaration.ts (conf=0.7)
  [WARN] /tmp/openhands-scan-target/frontend/src/i18n/declaration.ts (conf=0.7)
  [WARN] /tmp/openhands-scan-target/frontend/src/i18n/declaration.ts (conf=0.7)
  [WARN] /tmp/openhands-scan-target/frontend/src/routes/secrets-settings.tsx (conf=0.7)
  [WARN] /tmp/openhands-scan-target/openhands/core/config/utils.py (conf=0.7)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/test_saas_nested_conversation_manager_token_refresh.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/server/routes/test_jira_dc_integration_routes.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/server/routes/test_jira_dc_integration_routes.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/server/routes/test_jira_dc_integration_routes.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/server/routes/test_jira_dc_integration_routes.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/server/routes/test_linear_integration_routes.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/server/routes/test_linear_integration_routes.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/server/routes/test_linear_integration_routes.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/server/routes/test_linear_integration_routes.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/server/routes/test_orgs.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/server/routes/test_orgs.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/server/routes/test_jira_integration_routes.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/server/routes/test_jira_integration_routes.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/server/routes/test_jira_integration_routes.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/server/routes/test_jira_integration_routes.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/server/routes/test_jira_integration_routes.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/server/routes/test_jira_integration_routes.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/server/routes/test_jira_integration_routes.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/storage/test_gitlab_webhook_store.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/storage/test_gitlab_webhook_store.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/storage/test_gitlab_webhook_store.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/storage/test_gitlab_webhook_store.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/integrations/linear/conftest.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/integrations/jira/conftest.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/enterprise/tests/unit/integrations/jira_dc/conftest.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/tests/unit/core/logger/test_logging.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/tests/unit/core/logger/test_logging.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/tests/unit/core/logger/test_logging.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/tests/unit/core/logger/test_logger.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/tests/unit/core/config/test_kubernetes_config.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/tests/unit/core/config/test_kubernetes_config.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/tests/unit/core/config/test_config_precedence.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/tests/unit/core/config/test_config_precedence.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/tests/unit/runtime/test_runtime_git_tokens.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/tests/unit/server/data_models/test_conversation.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/tests/unit/server/data_models/test_conversation.py (conf=0.539)
  [INFO] /tmp/openhands-scan-target/openhands/resolver/README.md (conf=0.3332)
  [INFO] /tmp/openhands-scan-target/openhands/resolver/README.md (conf=0.3332)

Risk Score: 9.8 (HIGH)

Infrastructure-annotated findings: 7

================================================================================
  agent-audit v0.7.0 → v0.8.0 对比验证报告
  Target: OpenHands
================================================================================

一、总量对比
┌──────────────────┬──────────┬──────────┬──────────┬────────────┐
│       指标       │  v0.7.0  │  v0.8.0  │   变化   │   目标     │
├──────────────────┼──────────┼──────────┼──────────┼────────────┤
│ Total Findings   │     395  │     455  │    +60  │  <240      │
│ BLOCK            │      54  │      30  │    -24  │  <22       │
│ WARN             │     133  │     101  │    -32  │            │
│ INFO             │     208  │     212  │     +4  │            │
│ Risk Score       │     9.8  │     9.8  │         │  3.0-7.0   │
└──────────────────┴──────────┴──────────┴──────────┴────────────┘

二、关键规则对比
┌────────────┬───────────┬───────────┬────────────────────────────┐
│  Rule      │  v0.7.0   │  v0.8.0   │  说明                      │
├────────────┼───────────┼───────────┼────────────────────────────┤
│ AGENT-001  │     17    │     17    │  — 不变                       │
│ AGENT-004  │      9    │     57    │  ↑ 增加 48                    │
│ AGENT-020  │     25    │     61    │  ✅ 测试FP消除                   │
│ AGENT-034  │     32    │     78    │  ↑ 增加 46                    │
│ AGENT-044  │      2    │      2    │  ✅ 标杆保留                     │
│ AGENT-045  │      3    │      3    │  ⚠️ 仍有3                     │
│ AGENT-047  │     25    │     44    │  ↑ 增加 19                    │
└────────────┴───────────┴───────────┴────────────────────────────┘

三、验收判定
────────────────────────────────────────────────────────────
  ❌ FAIL  总 findings 减少 >40%: -15%
  ❌ FAIL  BLOCK 数量减少 >60%: 44%
  ✅ PASS  AGENT-044 TP 保留 (≥2 BLOCK): 2 in BLOCK
  ✅ PASS  AGENT-020 测试 FP 消除 (≤3 non-SUPP): 0 non-SUPPRESSED
  ❌ FAIL  AGENT-045 测试 FP 消除 (0 non-SUPP): 3 non-SUPPRESSED
  ❌ FAIL  Risk Score 在 3.0-7.0 区间: 9.8

────────────────────────────────────────────────────────────
  ⚠️  4 项未通过 (2/6) — 需要进一步分析

四、TP 保护评估 (最重要)
────────────────────────────────────────────────────────────

以下 v0.7.0 的真阳性必须在 v0.8.0 中仍然被检出 (BLOCK 或 WARN 层):

  1. AGENT-044: runtime_init.py 中的 NOPASSWD sudoers
     → v0.8.0: ✅ 保留

  2. AGENT-034: git_diff.py 中 sys.argv → subprocess shell=True
     → v0.8.0: 请在 BLOCK/WARN findings 中人工确认 git_diff.py 是否存在

  3. AGENT-004: 真实硬编码凭证 (如果 OpenHands 中有)
     → v0.8.0: 请在 AGENT-004 findings 中人工确认

  4. AGENT-001: 真实的用户输入 → subprocess 路径 (非容器初始化)
     → v0.8.0: 请在 AGENT-001 findings 中人工确认

